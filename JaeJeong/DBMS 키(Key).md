# π“ ν‚¤ (Key)

λ°μ΄ν„°λ² μ΄μ¤μ—μ„ μ΅°κ±΄μ— λ§μ΅±ν•λ” νν”μ„ μ°Ύκ±°λ‚ μμ„λ€λ΅ μ •λ ¬ν•  λ•, λ‹¤λ¥Έ νν”λ“¤κ³Ό κµ¬λ³„ν•  μ μλ” `μ μΌν• κΈ°μ¤€`μ΄ λλ” μ†μ„±

<br>

## Key Constraints

ν•λ‚ λλ” κ·Έ μ΄μƒμ fieldsκ°€ λ¨μ—¬ keyκ°€ λ  μ μλ‹¤.

<br>

### μµμ†μ„±
        
- `ν•λ‚μ ν‚¤μ— λ€μ‘ν•λ” νν”μ€ μ¤μ§ ν•λ‚`μ—¬μ•Ό ν•λ‹¤.
- `μµμ†ν•` β† μ μ΅°κ±΄μ„ λ§μ΅±ν•΄μ•Όν•λ‹¤. λ‹¤λ¥Έ ν•λ‚λ¥Ό λΊμ„ λ• μ—¬μ „ν νν”μ„ μ μΌν•κ² μ‹λ³„ν•  μ μλ‹¤λ©΄, μµμ†μ„±μ„ λ§μ΅±ν•μ§€ μ•λ” κ²ƒ !

```sql
'(μ£Όλ―Όλ“±λ΅λ²νΈ, λ‚μ΄, μ‚¬λ” κ³³, νμ•΅ν•)' β†’ 'ν‚¤(μ£Όλ―Όλ“±λ΅λ²νΈ, λ‚μ΄)'

=> μµμ†μ„±μ„ λ§μ΅±ν•μ§€ μ•λ” ν‚¤, λ‚μ΄κ°€ κµ³μ΄ μ—†λ”λΌλ„ νν”μ„ μ μΌν•κ² μ‹λ³„ν•  μ μκΈ° λ•λ¬Έ !
```

<br>

### μ μΌμ„±

- `ν•λ‚μ ν‚¤ κ°’`μΌλ΅ νν”μ„ `μ μΌν•κ² μ‹λ³„`ν•  μ μμ–΄μ•Ό ν•λ‹¤.

```sql
'(μ£Όλ―Όλ“±λ΅λ²νΈ, λ‚μ΄, μ‚¬λ” κ³³, νμ•΅ν•)' β†’ 'ν‚¤(μ£Όλ―Όλ“±λ΅λ²νΈ)'

=> μ μΌμ„±μ„ λ§μ΅±ν•λ” ν‚¤, κ·Έ μ™Έμ μ†μ„±λ“¤μ€ μ¤‘λ³µλ  μ μκΈ° λ•λ¬Έμ— μ μΌμ„±μ„ λ§μ΅±ν•μ§€ X
```

<br>

---

<br>


## μνΌν‚¤ (Super Key)

- `μ μΌμ„± O`, `μµμ†μ„± X`
- ex. (ν•™λ² + μ΄λ¦„), (μ£Όλ―Όλ“±λ΅λ²νΈ + λ‚μ΄)

<br>

## ν›„λ³΄ν‚¤ (Candidate Key)

- `μ μΌμ„± O`, `μµμ†μ„± O`
- κΈ°λ³Έν‚¤(Primary Key)κ°€ λ  μ μλ” ν›„λ³΄ν‚¤
- ν›„λ³΄ν‚¤ μ¤‘ κΈ°λ³Έν‚¤λ΅ μ„ νƒλ°›μ§€ λ»ν• ν‚¤λ¥Ό `λ€μ²΄ν‚¤ (Alternate Key)`λΌκ³  ν•λ‹¤.

```sql
CREATE TABLE Enrolled (
  sid CHAR(20)
  cid CHAR(20),
  grade CHAR(2),
  PRIMARY KEY (sid),
  UNIQUE (cid, grade) -- λ³΄μ΅°ν‚¤ μ„ μ–Έ ν‚¤μ›λ“ : UNIQUE
); 
```

<br>

## κΈ°λ³Έν‚¤ (Primary Key)

- `μ μΌμ„± O`, `μµμ†μ„± O`
- ν›„λ³΄ν‚¤ μ¤‘ μ„ νƒλ°›μ€ ν‚¤

```sql
CREATE TABLE Enrolled (
  sid CHAR(20)
  cid CHAR(20),
  grade CHAR(2),
  PRIMARY KEY (sid, cid) -- κΈ°λ³Έν‚¤ μ„ μ–Έ ν‚¤μ›λ“ : PRIMARY KEY
);
```

<br>

### κΈ°λ³Έν‚¤μ νΉμ§•

μ—¬λ¬ ν›„λ³΄ν‚¤ μ¤‘ ν•λ‚μ κΈ°λ³Έν‚¤λ¥Ό μ„ νƒν•¨μ— μμ–΄ λ‹¤μμ κΈ°μ¤€μ„ ν†µκ³Όν•΄μ•Όν•λ‹¤.

1. NULL κ°’μ„ κ°€μ§ μ μλ” μ†μ„±μ΄ ν¬ν•¨λμ–΄ μμΌλ©΄ μ•λλ‹¤.
2. κ°’μ΄ λ³€κ²½λ  κ°€λ¥μ„±μ΄ λ†’μ€ μ†μ„±μ΄ ν¬ν•¨λμ–΄ μμΌλ©΄ μ•λλ‹¤.
3. λ‹¨μν• ν›„λ³΄ν‚¤λ¥Ό κΈ°λ³Έν‚¤λ΅ μ„ νƒν•λ‹¤.

<br>

## μ™Έλν‚¤ (Foreign Key)

- κ΄€κ³„λ¥Ό λ§Ίκ³  μλ” λ‹¤λ¥Έ ν…μ΄λΈ”μ ν‚¤λ¥Ό λ‚΄ ν…μ΄λΈ”μ— `μ°Έμ΅°`ν•΄μ„ μ‚¬μ©ν•λ” ν‚¤


```sql
CREATE TABLE Enrolled (
  sid CHAR(20)
  cid CHAR(20)
  grade CHAR(2),
  PRIMARY KEY (sid, cid),
  FOREIGN KEY (sid) REFERENCES Students (sid) -- μ™Έλν‚¤ μ„ μ–Έ ν‚¤μ›λ“ : FOREIGN KEY ~ REFERENCES ~
);
```

<br><br>

# π“ μ¤ν”„λ§μ—μ„μ κΈ°λ³Έν‚¤ λ§¤ν•‘
## @Id
```java
@Entity
public class User {
    @Id
    private String id;
}
```
- λ°μ΄ν„°λ² μ΄μ¤ ν…μ΄λΈ”μ κΈ°λ³Έ ν‚¤(PK)μ™€ κ°μ²΄μ ν•„λ“λ¥Ό λ§¤ν•‘μ‹μΌμ£Όλ” μ–΄λ…Έν…μ΄μ…
- @GeneratedValue μ–΄λ…Έν…μ΄μ…μ„ κ°™μ΄ μ‚¬μ©ν•΄μ£Όμ§€ μ•μ„ κ²½μ° κΈ°λ³Έ ν‚¤λ¥Ό μ§μ ‘ ν• λ‹Ήν•΄μ£Όμ–΄μ•Ό ν•λ‹¤.

<br>

## @GeneratedValue
```java
@Entity
public class User {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private String id;
}
```
- κΈ°λ³Έν‚¤λ¥Ό μλ™μΌλ΅ μƒμ„±ν•΄μ£Όλ” μ–΄λ…Έν…μ΄μ…

<br>

### μ „λµ
1. `IDENTITY`
    - κΈ°λ³Έν‚¤ μƒμ„±μ„ λ°μ΄ν„°λ² μ΄μ¤μ— μ„μ„ν•λ” μ „λµ
    - μ£Όλ΅ MySQL, PostgreSQL, SQL Serverμ—μ„ μ‚¬μ©ν•λ‹¤.
2. `SEQUENCE`
    - μ‹ν€€μ¤λ¥Ό μ‚¬μ©ν•΄μ„ κΈ°λ³Έν‚¤λ¥Ό μƒμ„±ν•λ” μ „λµ
    - μ‹ν€€μ¤λ¥Ό μ§€μ›ν•λ” Oracle, PostgreSQL, H2μ—μ„ μ‚¬μ©ν•  μ μλ‹¤.
    - π‘‡ μ‚¬μ©λ²• π‘‡
      ```java
      @Entity
      @SequenceGenerator( // 1. μ‹ν€€μ¤ μƒμ„±κΈ° λ“±λ΅
              name = "BOARD_SEQ_GENERATOR",
              sequenceName = "BOARD_SEQ",
              initialValue = 1,
              allocationSize = 1
      )
      public class User {
          @Id
          @GeneratedValue(strategy = GenerationType.SEQUENCE,
                          generator = "BOARD_SEQ_GENERATOR") // 2. μ‹ν€€μ¤ μƒμ„±κΈ° μ„ νƒ
          private Long id;
      }
      ```
    - SequenceGenerator μ†μ„±
      1. name : μ‹ν€€μ¤ μƒμ„±κΈ° μ΄λ¦„
      2. sequenceName : λ°μ΄ν„°λ² μ΄μ¤μ— λ“±λ΅λμ–΄ μλ” μ‹ν€€μ¤ μƒμ„±κΈ° μ΄λ¦„
      3. initialValue : μ‹ν€€μ¤μ μ‹μ‘κ°’ (κΈ°λ³Έκ°’ = 1)
      4. allocationSize
          - μ‹ν€€μ¤λ¥Ό ν• λ² νΈμ¶ν•  λ• μ¦κ°€ν•λ” μ (κΈ°λ³Έκ°’ = 50)
          - DB μ—λ” λ―Έλ¦¬ 50μ„ μ¬λ ¤λ†“κ³ , λ©”λ¨λ¦¬μƒμ—μ„ 1μ”© μ¬λ ¤μ„ λ§μ•½ 50κΉμ§€ λ‹¤μ‚¬μ©ν–λ‹¤λ©΄ λ‹¤μ‹ νΈμ¶ν•μ—¬ DBμ κ°’μ€ 100μΌλ΅ μ¬λ ¤ μ΄μ „ κ³Όμ •μ„ λ°λ³µ ! -> μ„±λ¥ μµμ ν™” !
          - λ°μ΄ν„°λ² μ΄μ¤ μ‹ν€€μ¤κ°’μ΄ 1 μ”© μ¦κ°€ν•λ‹¤λ©΄ λ°λ“μ‹ 1λ΅ μ§€μ •ν•΄μ•Ό ν•λ‹¤.
3. `TABLE`
    - ν‚¤ μƒμ„± μ „μ© ν…μ΄λΈ”μ„ μ‚¬μ©ν•μ—¬ κΈ°λ³Έν‚¤λ¥Ό μƒμ„±ν•λ” μ „λµ (-> μ‹ν€€μ¤λ¥Ό ν‰λ‚΄λ‚΄λ” μ „λµ !)
    - ν…μ΄λΈ”μ„ μ‚¬μ©ν•λ―€λ΅ λ¨λ“  λ°μ΄ν„°λ² μ΄μ¤μ— μ μ©ν•  μ μλ‹¤.
    - π‘‡ μ‚¬μ©λ²• π‘‡
      ```java
      @Entity
      @TableGenerator( // 1. ν…μ΄λΈ” μƒμ„±κΈ° λ“±λ΅
          name = "BOARD_SEQ_GENERATOR",
          table = "MY_SEQUENCES",
          pkColumnValue = "BOARD_SEQ", allocationSize = 1)
      public class Board {
          @Id
          @GeneratedValue(strategy = GenerationType.TABLE,
                          generator = "BOARD_SEQ_GENERATOR") // 2. ν…μ΄λΈ” μƒμ„±κΈ° μ„ νƒ
          private Long id;
      }
     ```
4. `AUTO`
    - μ„ νƒν• λ°μ΄ν„°λ² μ΄μ¤μ λ°©μ–Έμ— λ”°λΌ INDENTITY, SEQUENCE, TABLE μ „λµ μ¤‘ ν•λ‚λ¥Ό μλ™μΌλ΅ μ„ νƒν•λ” μ „λµ
    - λ°μ΄ν„°λ² μ΄μ¤λ¥Ό λ³€κ²½ν•΄λ„ μ½”λ“λ¥Ό μμ •ν•  ν•„μ”κ°€ μ—†λ‹¤λ” μ¥μ μ΄ μλ‹¤.
